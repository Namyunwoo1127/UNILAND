<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.elon.boot.domain.admin.model.store.AdminMapper">
	
	<!-- 공지사항 목록 -->
	<select id="selectAllNotices">
        SELECT * FROM NOTICE_TBL
        WHERE DELETE_YN = 'N'
        ORDER BY NOTICE_IMPORTANT DESC, NOTICE_CREATEAT DESC
    </select>

	<!-- 전체 회원 목록 조회 -->
    <select id="selectAllUsers" resultType="User">
        SELECT 
            USER_ID,
            USER_NAME,
            USER_EMAIL,
            USER_PHONE,
            USER_REGION,
            USER_SCHOOL,
            ADMIN_YN,
            DELETE_YN,
            CREATED_AT,
            UPDATED_AT
        FROM USER_TBL
        WHERE DELETE_YN = 'N'
          AND ADMIN_YN = 'N'
        ORDER BY CREATED_AT, USER_NAME DESC
    </select>
    
    <!-- 전체 중개사 목록 조회 -->
    <select id="selectAllRealtors" resultType="Realtor">
        SELECT 
            REALTOR_ID,
            REALTOR_PASSWORD,
            OFFICE_NAME,
            REALTOR_NAME,
            REALTOR_ADDRESS,
            REALTOR_PHONE,
            REALTOR_EMAIL,
            BUSINESS_NUM,
            CREATED_AT,
            UPDATED_AT,
            APPROVAL_STATUS
        FROM REALTOR_TBL
        WHERE DELETE_YN = 'N'
        ORDER BY CREATED_AT, REALTOR_NAME DESC
    </select>

	<!-- 회원 탈퇴 처리 -->
    <update id="deleteUser">
        UPDATE USER_TBL
        SET 
            DELETE_YN = 'Y',
            UPDATED_AT = SYSTIMESTAMP
        WHERE user_id = #{userId}
    </update>
    
    <update id="deleteRealtor">
        UPDATE REALTOR_TBL
        SET 
            DELETE_YN = 'Y',
            UPDATED_AT = SYSTIMESTAMP
        WHERE REALTOR_ID = #{realtorId}
    </update>
    
</mapper>